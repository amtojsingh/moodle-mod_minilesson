define ("mod_poodlltime/rsquestionmanager",["jquery","jqueryui","core/log","core/templates","mod_poodlltime/definitions","mod_poodlltime/modalformhelper","mod_poodlltime/modaldeletehelper","mod_poodlltime/moveitemhelper","mod_poodlltime/datatables"],function(a,b,c,d,e,f,g,h,i){"use strict";c.debug("RSQuestion manager: initialising");return{cmid:null,controls:null,init:function init(a){var b=this;b.contextid=a.contextid;b.tableid=a.tableid;b.register_events();b.process_html()},process_html:function process_html(){this.controls=[];this.controls.questionstable=i.getDataTable(this.tableid);this.controls.questionscontainer=a("#"+e.mod_poodlltime_items_cont);this.controls.noquestionscontainer=a("#"+e.mod_poodlltime_noitems_cont);this.controls.movearrows=a("#"+e.movearrow)},moveRow:function moveRow(a,b){console.log("moved");var c=this.controls.questionstable.row(a).index();console.log(c);var d=-1;if("down"===b){d=1}console.log(d);var e=this.controls.questionstable.row(c).data();e.order+=d;console.log(e);var f=this.controls.questionstable.row(c+d).data();f.order+=-d;console.log(f);this.controls.questionstable.row(c).data(f);this.controls.questionstable.row(c+d).data(e);this.controls.questionstable.page(0).draw(!1)},register_events:function register_events(){var b=this,i=[e.qtype_dictation,e.qtype_dictationchat,e.qtype_page,e.qtype_speechcards,e.qtype_listenrepeat,e.qtype_multichoice];f.init("."+e.component+"_addlink",b.contextid,function after_questionadd(c,e){c.id=e;c.typelabel=c.type;d.render("mod_poodlltime/itemlistitem",c).then(function(c){b.controls.questionstable.row.add(a(c)[0]).draw()});b.controls.noquestionscontainer.hide();b.controls.questionscontainer.show()});f.init("."+e.itemrow+"_editlink",b.contextid,function after_questionedit(c,d){var f="#"+e.itemrow+"_"+d;b.controls.questionstable.cell(a(f+" .c1")).data(c.name)});g.init("."+e.itemrow+"_deletelink",b.contextid,"deleteitem",function after_questiondelete(a){c.debug("after question delete");b.controls.questionstable.row("#"+e.itemrow+"_"+a).remove().draw();var d=b.controls.questionstable.rows().count();if(!d){b.controls.noquestionscontainer.show();b.controls.questionscontainer.hide()}});h.init("."+e.movearrow,b.contextid,function after_questionmove(c,d){var f="#"+e.itemrow+"_"+c,g=b.controls.questionstable.row(f).index(),h;if("up"==d){h=g-1}else if("down"==d){h=g+1}var i=a(".mod_poodlltime_item_row").eq(h),j=b.controls.questionstable.cell({row:g,column:0}).data(),k=b.controls.questionstable.cell({row:h,column:0}).data();b.controls.questionstable.cell({row:g,column:0}).data(k);b.controls.questionstable.cell({row:h,column:0}).data(j);b.controls.questionstable.draw()})}}});
//# sourceMappingURL=rsquestionmanager.min.js.map

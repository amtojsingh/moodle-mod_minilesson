{"version":3,"sources":["../src/listenrepeat.js"],"names":["define","$","log","ajax","def","polly","cloudpoodll","debug","init","index","itemdata","quizhelper","self","message","type","console","getComparison","items","game","pointer","target","capturedspeech","comparison","gotComparison","register_events","setvoice","getItems","uniqueid","on","stepdata","grade","do_next","start","audio","load","play","prop","text","setTimeout","length","answered","correct","nextPrompt","end","spliton","usevoice","mf","voice","text_items","customtext1","split","map","landr_targetWords","trim","filter","e","typed","each","item","fetch_polly_url","then","audiourl","Audio","src","appReady","hide","show","addClass","removeClass","Object","keys","forEach","idx","effect","realidx","data","landr_targetWord","val","getWords","thetext","toLowerCase","chunks","words","i","match","push","getSimpleComparison","passage","transcript","callback","pwords","twords","ret","pi","call","methodname","args","alternatives","language","done","ajaxresult","payloadobject","JSON","parse","fail","err","numCorrect","totalNum","html","fadeOut","spoken","code","color","progress","join","toggle","direction","nextReply","landr_targetWordsCode","word","append","mobile_user","trigger"],"mappings":"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","sourcesContent":["define(['jquery', 'core/log', 'core/ajax', 'mod_poodlltime/definitions', 'mod_poodlltime/pollyhelper', 'mod_poodlltime/cloudpoodllloader'], function($, log, ajax, def, polly, cloudpoodll) {\n  \"use strict\"; // jshint ;_;\n\n  log.debug('Poodll Time dictation chat: initialising');\n\n  return {\n\n    init: function(index, itemdata, quizhelper) {\n      var self = this;\n      cloudpoodll.init('poodlltime-poodllrecorder', function(message) {\n\n        switch (message.type) {\n          case 'recording':\n            break;\n\n          case 'speech':\n            console.log(message);\n            self.getComparison(\n              self.items[self.game.pointer].target,\n              message.capturedspeech,\n              function(comparison) {\n                self.gotComparison(comparison, message);\n              }\n            );\n            break;\n\n        }\n\n      });\n      self.itemdata = itemdata;\n      self.quizhelper = quizhelper;\n      self.index = index;\n      self.register_events();\n      self.setvoice();\n      self.getItems();\n    },\n\n    register_events: function() {\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .poodlltime_nextbutton\").on('click', function(e) {\n        var stepdata = {};\n        var grade = 50;\n        stepdata.index = self.index;\n        stepdata.grade = grade;\n        self.quizhelper.do_next(stepdata);\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").on(\"click\", function() {\n        self.start();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_listen_btn\").on(\"click\", function() {\n        self.items[self.game.pointer].audio.load();\n        self.items[self.game.pointer].audio.play();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_skip_btn\").on(\"click\", function() {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speech.landr_teacher_left\").text(self.items[self.game.pointer].target + \"\");\n        setTimeout(function() {\n          if (self.game.pointer < self.items.length - 1) {\n            self.items[self.game.pointer].answered = true;\n            self.items[self.game.pointer].correct = false;\n            self.game.pointer++;\n            self.nextPrompt();\n          } else {\n            self.end();\n          }\n        }, 3000);\n      });\n    },\n    spliton: new RegExp('([,.!?:;\" ])', 'g'),\n    game: {\n      pointer: 0\n    },\n    usevoice: 'Amy',\n    setvoice: function() {\n      var self = this;\n      var language = \"English(US)\";\n      var mf = \"Female\";\n      var voice = 'Amy';\n      switch (language) {\n        case \"English(US)\":\n          voice = mf === 'Male' ? 'Joey' : 'Kendra';\n          break;\n        case \"English(GB)\":\n          voice = mf === 'Male' ? 'Brian' : 'Amy';\n          break;\n        case \"English(AU)\":\n          voice = mf === 'Male' ? 'Russell' : 'Nicole';\n          break;\n        case \"English(IN)\":\n          voice = mf === 'Male' ? 'Aditi' : 'Raveena';\n          break;\n        case \"English(Welsh)\":\n          voice = mf === 'Male' ? 'Geraint' : 'Geraint';\n          break;\n        case \"Danish\":\n          voice = mf === 'Male' ? 'Mads' : 'Naja';\n          break;\n        case \"Dutch\":\n          voice = mf === 'Male' ? 'Ruben' : 'Lotte';\n          break;\n        case \"French(FR)\":\n          voice = mf === 'Male' ? 'Mathieu' : 'Celine';\n          break;\n        case \"French(CA)\":\n          voice = mf === 'Male' ? 'Chantal' : 'Chantal';\n          break;\n        case \"German\":\n          voice = mf === 'Male' ? 'Hans' : 'Marlene';\n          break;\n        case \"Icelandic\":\n          voice = mf === 'Male' ? 'Karl' : 'Dora';\n          break;\n        case \"Italian\":\n          voice = mf === 'Male' ? 'Carla' : 'Giorgio';\n          break;\n        case \"Japanese\":\n          voice = mf === 'Male' ? 'Takumi' : 'Mizuki';\n          break;\n        case \"Korean\":\n          voice = mf === 'Male' ? 'Seoyan' : 'Seoyan';\n          break;\n        case \"Norwegian\":\n          voice = mf === 'Male' ? 'Liv' : 'Liv';\n          break;\n        case \"Polish\":\n          voice = mf === 'Male' ? 'Jacek' : 'Ewa';\n          break;\n        case \"Portugese(BR)\":\n          voice = mf === 'Male' ? 'Ricardo' : 'Vitoria';\n          break;\n        case \"Portugese(PT)\":\n          voice = mf === 'Male' ? 'Cristiano' : 'Ines';\n          break;\n        case \"Romanian\":\n          voice = mf === 'Male' ? 'Carmen' : 'Carmen';\n          break;\n        case \"Russian\":\n          voice = mf === 'Male' ? 'Maxim' : 'Tatyana';\n          break;\n        case \"Spanish(ES)\":\n          voice = mf === 'Male' ? 'Enrique' : 'Conchita';\n          break;\n        case \"Spanish(US)\":\n          voice = mf === 'Male' ? 'Miguel' : 'Penelope';\n          break;\n        case \"Swedish\":\n          voice = mf === 'Male' ? 'Astrid' : 'Astrid';\n          break;\n        case \"Turkish\":\n          voice = mf === 'Male' ? 'Filiz' : 'Filiz';\n          break;\n        case \"Welsh\":\n          voice = mf === 'Male' ? 'Gwyneth' : 'Gwyneth';\n          break;\n        default:\n          voice = mf === 'Male' ? 'Brian' : 'Amy';\n      }\n      self.usevoice = voice;\n    },\n    getItems: function() {\n      var self = this;\n\n      var text_items = self.itemdata.customtext1.split(\"\\n\");\n\n      self.items = text_items.map(function(target) {\n        return {\n          landr_targetWords: target.trim().split(self.spliton).filter(function(e) {\n            return e !== \"\";\n          }),\n          target: target,\n          typed: \"\",\n          answered: false,\n          correct: false,\n          audio: null\n        };\n      }).filter(function(e) {\n        return e.target !== \"\";\n      });\n\n      $.each(self.items, function(index, item) {\n        polly.fetch_polly_url(item.target, 'text', 'Amy').then(function(audiourl) {\n          item.audio = new Audio();\n          item.audio.src = audiourl;\n          if (self.items.filter(function(e) {\n              return e.audio == null\n            }).length == 0) {\n            self.appReady();\n          } else {\n            console.log(self.items);\n          }\n        });\n      });\n\n    },\n    appReady: function() {\n      var self = this;\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_not_loaded\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_loaded\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").prop(\"disabled\", false);\n    },\n    gotComparison: function(comparison, typed) {\n\n      console.log(comparison, typed);\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").addClass(\"landr_correct\").removeClass(\"landr_incorrect\");\n\n      if (!Object.keys(comparison).length) {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speech.landr_teacher_left\").text(self.items[self.game.pointer].target + \"\");\n\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = true;\n        self.items[self.game.pointer].typed = typed;\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n        if (self.game.pointer < self.items.length - 1) {\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 3000);\n        } else {\n          setTimeout(function() {\n            self.end();\n          }, 3000);\n        }\n\n      } else {\n\n        Object.keys(comparison).forEach(function(idx) {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord[data-idx='\" + idx + \"']\").removeClass(\"landr_correct\").addClass(\"landr_incorrect\");\n        });\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_reply_\" + self.game.pointer).effect(\"shake\", function() {\n\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);\n\n        });\n\n      }\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord.landr_correct\").each(function() {\n        var realidx = $(this).data(\"realidx\");\n        var landr_targetWord = self.items[self.game.pointer].landr_targetWords[realidx];\n        $(this).val(landr_targetWord).prop(\"disabled\", true);\n      });\n\n    },\n    getWords: function(thetext) {\n      var self = this;\n      var checkcase = false;\n      if (checkcase == 'false') {\n        thetext = thetext.toLowerCase();\n      }\n      var chunks = thetext.split(self.spliton).filter(function(e) {\n        return e !== \"\";\n      });\n      var words = [];\n      for (var i = 0; i < chunks.length; i++) {\n        if (!chunks[i].match(self.spliton)) {\n          words.push(chunks[i]);\n        }\n      }\n      return words;\n    },\n    getSimpleComparison(passage, transcript, callback) {\n      var self = this;\n      var pwords = self.getWords(passage);\n      var twords = self.getWords(transcript);\n      var ret = {};\n      for (var pi = 0; pi < pwords.length && pi < twords.length; pi++) {\n        if (pwords[pi] != twords[pi]) {\n          ret[pi + 1] = {\n            \"word\": pwords[pi],\n            \"number\": pi + 1\n          };\n        }\n      }\n      callback(ret);\n    },\n    getComparison: function(passage, transcript, callback) {\n      var self = this;\n      /*\n      var comparison = \"simple\";\n      if (comparison == 'simple') {\n        self.getSimpleComparison(passage, transcript, callback);\n        return;\n      }\n      */\n\n      console.log(passage,transcript);\n      \n      $(\".landr_ctrl-btn\").prop(\"disabled\", true);\n\n      ajax.call([{\n        methodname: 'mod_readaloud_compare_passage_to_transcript',\n        args: {\n          passage: passage,\n          transcript: transcript,\n          alternatives: '',\n          language: 'en-US'\n        },\n        done: function(ajaxresult) {\n          var payloadobject = JSON.parse(ajaxresult);\n          if (payloadobject) {\n            callback(payloadobject);\n          } else {\n            callback(false);\n          }\n        },\n        fail: function(err) {\n          console.log(err);\n        }\n      }]);\n\n    },\n    end: function() {\n      var self = this;\n\n      var numCorrect = self.items.filter(function(e) {\n        return e.correct;\n      }).length;\n\n      var totalNum = self.items.length;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_results\").html(\"TOTAL<br/>\" + numCorrect + \"/\" + totalNum).show();\n\n      setTimeout(function() {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_results\").fadeOut(function() {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").show();\n        });\n      }, 2000);\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_mainmenu\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_controls\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_title\").html(\"Listen and Repeat\");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speakbtncontainer\").hide();\n\n    },\n    start: function() {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speakbtncontainer\").show();\n\n      self.items.forEach(function(item) {\n        item.spoken = \"\";\n        item.answered = false;\n        item.correct = false;\n      });\n\n      self.game.pointer = 0;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_mainmenu\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_controls\").show();\n\n      self.nextPrompt();\n\n    },\n    nextPrompt: function() {\n\n      var showText = true;\n      var self = this;\n\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='landr_prompt landr_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n      code += \"<i class='fa fa-graduation-cap landr_speech-icon-left'></i>\";\n      code += \"<div style='margin-left:90px;' class='landr_speech landr_teacher_left'>\";\n      if(!showText){\n        code += target.replace(/[^a-zA-Z0-9 ]/g, '').replace(/[a-zA-Z0-9]/g, '•');\n      } else{\n        code += target;\n      }\n      code += \"</div>\";\n      code += \"</div>\";\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").html(code);\n      $(\".landr_ctrl-btn\").prop(\"disabled\", false);\n\n      var color;\n\n      var progress = self.items.map(function(item, idx) {\n        color = \"gray\";\n        if (self.items[idx].answered && self.items[idx].correct) {\n          color = \"green\";\n        } else if (self.items[idx].answered && !self.items[idx].correct) {\n          color = \"red\";\n        }\n        return \"<i style='color:\" + color + \"' class='fa fa-circle'></i>\";\n      }).join(\" \");\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_title\").html(progress);\n      $(\".landr_prompt_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'left'\n      });\n\n      self.nextReply();\n\n    },\n    nextReply: function() {\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='landr_reply landr_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n      code += \"<i class='fa fa-user landr_speech-icon-right'></i>\";\n      var landr_targetWordsCode = \"\";\n      var idx = 1;\n      self.items[self.game.pointer].landr_targetWords.forEach(function(word, realidx) {\n        if (!word.match(self.spliton)) {\n          landr_targetWordsCode += \"<input disabled type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='landr_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'>\";\n          idx++;\n\n        } else {\n          landr_targetWordsCode += word;\n        }\n      });\n      code += \"<div style='margin-right:90px;' class='landr_speech landr_right'>\" + landr_targetWordsCode + \"</div>\";\n      code += \"</div>\";\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").append(code);\n      $(\".landr_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);\n      if(!self.quizhelper.mobile_user()){\n        setTimeout(function(){\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_listen_btn\").trigger('click');\n        },1000);\n      }\n    }\n\n  };\n});"],"file":"listenrepeat.min.js"}
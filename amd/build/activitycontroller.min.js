define(["jquery","jqueryui","core/log","mod_poodlltime/definitions","mod_poodlltime/quizhelper","mod_poodlltime/pollyhelper"],function(a,b,c,d,e,f){"use strict";return c.debug("Activity controller: initialising"),{cmid:null,activitydata:null,sorryboxid:null,controls:null,init:function(b){var d=this,e="#amdopts_"+b.widgetid,g=a(e).get(0);return g?(d.activitydata=JSON.parse(g.value),a(e).remove(),d.cmid=b.cmid,d.attemptid=1,d.sorryboxid=b.widgetid+"_sorrybox",f.init(d.activitydata.token,d.activitydata.region,d.activitydata.owner),d.register_events(),d.process_html(),void d.doquizlayout()):void c.debug("Poodll Time Test Controller: No config found on page. Giving up.")},process_html:function(){var b=this.activitydata,c={introbox:a(".mod_intro_box"),quizcontainer:a("."+b.quizcontainer),feedbackcontainer:a("."+b.feedbackcontainer),errorcontainer:a("."+b.errorcontainer),instructionscontainer:a("."+b.instructionscontainer),wheretonextcontainer:a("."+b.wheretonextcontainer)};this.controls=c},register_events:function(){},doquizlayout:function(){var a=this;a.controls.instructionscontainer.hide(),e.onSubmit=function(b){a.dofinishedreadinglayout(b)},e.init(a.controls.quizcontainer,this.activitydata.quizdata,this.cmid,this.attemptid,f),a.controls.quizcontainer.show()},doerrorlayout:function(){this.controls.errorcontainer.show(),this.controls.wheretonextcontainer.show()}}});